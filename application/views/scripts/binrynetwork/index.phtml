<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
<title></title>
<meta name="description" content="overview &amp; stats" />
  <!-- Bootstrap Core CSS -->
  <link href="/gainbitcoin/css/bootstrap.min.css" rel="stylesheet">
  <!-- MetisMenu CSS -->
  <link href="/gainbitcoin/css/metisMenu.min.css" rel="stylesheet">
  <!-- Timeline CSS -->
  <link href="/gainbitcoin/css/timeline.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link href="/gainbitcoin/css/sb-admin-2.css" rel="stylesheet">
  <link href="/gainbitcoin/css/style.css" rel="stylesheet">
  <link href="/gainbitcoin/css/jquery.dataTables.min.css" rel="stylesheet">

  	 
  	  	  <script src="/gainbitcoin/js/jquery-1.11.2.min.js"></script>
 <script src="/gainbitcoin/js/d3.v3.min.js"></script>
      <!-- Bootstrap Core JavaScript -->
      <script src="/gainbitcoin/js/bootstrap.min.js"></script>
      <!-- Metis Menu Plugin JavaScript -->
      <script src="/gainbitcoin/js/metisMenu.min.js"></script>
	  
	   <script src="/gainbitcoin/js/metisMenu.js"></script>
      <!-- Morris Charts JavaScript -->
      <script src="/gainbitcoin/js/raphael-min.js"></script>

<!-- <script src="js/morris.min.js"></script>
  <script src="js/morris-data.js"></script>-->

  <!-- Custom Theme JavaScript -->
  <script src="/gainbitcoin/js/sb-admin-2.js"></script> 
  <!-- network Js-->

		
		<link href="/gainbitcoin/css/responsive.bootstrap.min.css" rel="stylesheet">
		<link href="/gainbitcoin/css/dataTables.bootstrap.min.css" rel="stylesheet">
		<script src="/gainbitcoin/js/jquery-1.12.3.js"></script>
		<script src="/gainbitcoin/js/jquery.dataTables.min.js"></script>
		<script src="/gainbitcoin/js/dataTables.bootstrap.min.js"></script>
		<script src="/gainbitcoin/js/dataTables.responsive.min.js"></script>
		<script src="/gainbitcoin/js/responsive.bootstrap.min.js"></script>  

<script type="text/javascript" data-cfasync="false"
	src="/gainbitcoin/js/data-tables-script.js"></script>
	

<script>


</script>	

<style>

.adjustment{
	width: 53.3333%;
}
 .popup_container
{
	background-image:url("images/popup-bg.png");
	background: #fff none repeat scroll 0 0;
	width:100%;
	z-index:9999;
	position:fixed;
	width: 57% !important;
	top: 8%;
	display:none;
	left: 16% !important;

} 


@media only screen and (max-width: 767px){
			
			#mobileadjust{
					float: right;
			}

		}
	
				
			
        

</style>
</head>
<body onload="changepagination();">	
				   
 			        
		 		 
		 	<div class="modal" id="myModaloffer" style="display:none;">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="hidemyoffer();">
                                    <i class="is close-btn" ></i></button>
                                </div>
                                <div class="modal-body"><a href="javascript:void(0)"><img alt="" src="images/banner_specialoffer.png"> </a></div>

                            </div><!-- /.modal-content -->
                        </div><!-- /.modal-dialog -->
				</div>

  <div id="wrapper">
<!-- Navigation -->



        <!-- Navigation -->
                    <div class="modal" id="myModal">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                    <i class="is close-btn"></i></button>
                                </div>
                                <div class="modal-body"><a href="javascript:void(0)"><img alt="" src="images/offer_popup_img.png"> </a></div>

                            </div><!-- /.modal-content -->
                        </div><!-- /.modal-dialog -->
                    </div>   




    <style>
      #menu, #sample .footer ,  #sample p,.breadcrumb>li+li:before {
      display: none;
      }
      li a:hover, a li:focus {
          background: transparent;
          color: #364a5e;
      }
      #sample {
          margin-left: auto;
          margin-bottom: 30px;
          position: relative;
      }


      .node{
          cursor: pointer;
      }

      .node circle{
          stroke: #fff;
          stroke-width:0.5;
      }

      .link{
          fill: none;
          stroke: lightgray;
          stroke-width: 1.5px;
      }

      div#tooltip{
          color:#ffffff;
          background:#fff;
          opacity:1;
          padding:5px;
      }
      #tree {
        margin: 0 auto;
         width: 700px;
      }
		  
	  .popup{
			background-image: url(../images/popup-bg.png);
			display:none;
			width: 100%;
			height: 100%;
			position: fixed;
			z-index: 9999;
			top: 150;
		}
		@media (max-width: 1200px){
          #tree {
          margin: 0 auto;
          width: 300px;
        }
      }
    </style>
      <div id="innerpage-wrapper">
        <div class="row lightgraybg">
          <div class="col-lg-12 offset-1">
            <h1 class="page-header gain-bit-Titletxt innpercontentPad">MY Network</h1>
          </div>
          <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
        <div class="row">
          <ol class="breadcrumb">
            <li><a href="<?php echo BASEPATH?>/Admindashboar">Home</a> > </li>
           <li><a href="<?php echo BASEPATH?>/Binaryuser">Users</a> > </li>
            <li class="active">Network</li>
          </ol>
	<!--	<div id = "Popup" class = "popup">
  <div id = "ajax-loader1" class = "center" style = "padding: 150px;"><img src = "/gainbitcoin/images/ajax-loader-blue.gif" /></div>
 </div> -->
          <div class="network-info">
            <div class="col-lg-5 col-xs-5 left-inline mob-view">
              <div class="col-lg-6 col-xs-6">
                <div class="input-type-select">
                  <select name="search_level" id = "search_level" disabled>
                    <option value="">Search by Level</option>
      
                  </select>
                </div>
              </div>
              <div class="col-lg-6 col-xs-6">
                <div class="input-type-select">
                  <select name="search_user" id = "search_user" disabled>
                    <option value = "">Search by Name</option>
 
                  </select>
                </div>
              </div>
              <div class="clearfix"></div>
          </div>
            <div class="col-lg-7 col-xs-7 mob-view">
              <div class="col-lg-9 col-xs-9">
                <div class="input-type-search">
                  <input id="username_search" type="text" placeholder="Search for username in network">
                   <a href="javascript:void(0)" onclick="search_user();" class="search"></a>
                </div>

                </div>
              <div class="col-lg-3 col-xs-3"><input id="refresh_network" type="button" class="btn_" value="REFRESH"></div>
            </div>
            <div class="clearfix"></div>
          </div>
          <div class="summary-container">
            <div class="sum-header">My Summary</div>
            <div class="sum-content">
              <div class="sum-row-head">
                <div class="col-lg-4 col-xs-4 head">Left Users</div>
                <div class="col-lg-4 col-xs-4">&nbsp;</div>
                <div class="col-lg-4 col-xs-4 head">Right Users</div>
                <div class="clearfix"></div>
              </div>
              <div class="sum-row">
                <div class="col-lg-4 col-xs-4">0 BTC</div>
                <div class="col-lg-4 col-xs-4 info">Total Contracts</div>
                <div class="col-lg-4 col-xs-4">1 BTC</div>
                <div class="clearfix"></div>
              </div>
               <div class="sum-row">
                <div class="col-lg-4 col-xs-4">0</div>
                <div class="col-lg-4 col-xs-4 info">Total Users</div>
                <div class="col-lg-4 col-xs-4">6</div>
                <div class="clearfix"></div>
              </div>
               <div class="sum-row">
                <div class="col-lg-4 col-xs-4">0</div>
                <div class="col-lg-4 col-xs-4 info">Active Users</div>
                <div class="col-lg-4 col-xs-4">1</div>
                <div class="clearfix"></div>
              </div>
               <div class="sum-row">
                <div class="col-lg-4 col-xs-4">0</div>
                <div class="col-lg-4 col-xs-4 info">Inactive Users</div>
                <div class="col-lg-4 col-xs-4">5</div>
                <div class="clearfix"></div>
              </div>
          </div>
          </div>
          <div class="clearfix">
            <div class="col-lg-12 ">
              <div class="info-tree"><img src="images/info.png" alt=""></div>
              <div id="sample">
                  <div id='tree'></div>
                  <div id="tooltip">
              </div>

            </div>
        </div>
      </div> 
    </div>
  </div>
  <input type="hidden" id="binarydatarr" value='[{"name":"ops","parent":"null","isactive":"1","lock_status":"unlock","child_position":"","amtpaid":"0.80","sponsor":"virender13","date":"2016-08-20 00:00:00","key":1,"parent_id":1},{"name":"amolk","parent":"ops","isactive":"","lock_status":"unlock","child_position":"L","amtpaid":"","sponsor":"ops","date":"","key":2,"parent_id":1},{"name":"ops1","parent":"ops","isactive":"1","lock_status":"unlock","child_position":"R","amtpaid":"0.20","sponsor":"virender13","date":"2016-08-29 11:31:15","key":3,"parent_id":1},{"name":"ops11","parent":"ops1","isactive":"","lock_status":"unlock","child_position":"L","amtpaid":"","sponsor":"ops1","date":"","key":4,"parent_id":3},{"name":"N\/A","parent":"ops11","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":5,"parent_id":4},{"name":"ops12","parent":"ops11","isactive":"","lock_status":"unlock","child_position":"R","amtpaid":"","sponsor":"virender13","date":"","key":6,"parent_id":4},{"name":"N\/A","parent":"ops12","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":7,"parent_id":6},{"name":"ops121","parent":"ops12","isactive":"","lock_status":"unlock","child_position":"R","amtpaid":"","sponsor":"virender13","date":"","key":8,"parent_id":6},{"name":"ops12111","parent":"ops1","isactive":"","lock_status":"unlock","child_position":"R","amtpaid":"","sponsor":"virender13","date":"","key":9,"parent_id":3},{"name":"N\/A","parent":"ops12111","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":10,"parent_id":9},{"name":"amol12dxscdsds3fsdfsdf","parent":"ops12111","isactive":"","lock_status":"","child_position":"R","amtpaid":"","sponsor":"","date":"","key":11,"parent_id":9},{"name":"N\/A","parent":"amol12dxscdsds3fsdfsdf","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":12,"parent_id":11},{"name":"amol12dxsxghcdsds3fsdfsdf","parent":"amol12dxscdsds3fsdfsdf","isactive":"","lock_status":"","child_position":"R","amtpaid":"","sponsor":"","date":"","key":13,"parent_id":11}]'>
  <input type = "hidden" id = "history_counter" />
			<input type = "hidden" id = "master" value="ops"/>
			<input type = "hidden" id = "child_user" value=" ops"/>
			<input type = "hidden" id = "parent_user" value=" ops" />
      
        <script type="text/javascript">
      window.onload=function(){
	var binaryarr=[{"name":"ops","parent":"null","isactive":"1","lock_status":"unlock","child_position":"","amtpaid":"0.80","sponsor":"virender13","date":"2016-08-20 00:00:00","key":1,"parent_id":1},{"name":"amolk","parent":"ops","isactive":"","lock_status":"unlock","child_position":"L","amtpaid":"","sponsor":"ops","date":"","key":2,"parent_id":1},{"name":"ops1","parent":"ops","isactive":"1","lock_status":"unlock","child_position":"R","amtpaid":"0.20","sponsor":"virender13","date":"2016-08-29 11:31:15","key":3,"parent_id":1},{"name":"ops11","parent":"ops1","isactive":"","lock_status":"unlock","child_position":"L","amtpaid":"","sponsor":"ops1","date":"","key":4,"parent_id":3},{"name":"N\/A","parent":"ops11","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":5,"parent_id":4},{"name":"ops12","parent":"ops11","isactive":"","lock_status":"unlock","child_position":"R","amtpaid":"","sponsor":"virender13","date":"","key":6,"parent_id":4},{"name":"N\/A","parent":"ops12","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":7,"parent_id":6},{"name":"ops121","parent":"ops12","isactive":"","lock_status":"unlock","child_position":"R","amtpaid":"","sponsor":"virender13","date":"","key":8,"parent_id":6},{"name":"ops12111","parent":"ops1","isactive":"","lock_status":"unlock","child_position":"R","amtpaid":"","sponsor":"virender13","date":"","key":9,"parent_id":3},{"name":"N\/A","parent":"ops12111","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":10,"parent_id":9},{"name":"amol12dxscdsds3fsdfsdf","parent":"ops12111","isactive":"","lock_status":"","child_position":"R","amtpaid":"","sponsor":"","date":"","key":11,"parent_id":9},{"name":"N\/A","parent":"amol12dxscdsds3fsdfsdf","isactive":"","lock_status":"","child_position":"L","amtpaid":"","sponsor":"","date":"","key":12,"parent_id":11},{"name":"amol12dxsxghcdsds3fsdfsdf","parent":"amol12dxscdsds3fsdfsdf","isactive":"","lock_status":"","child_position":"R","amtpaid":"","sponsor":"","date":"","key":13,"parent_id":11}];
	$('#binarydatarr').val(JSON.stringify(binaryarr));
	$('#child_user').val=binaryarr[0]['name'];
	$('#parent_user').val=binaryarr[0]['name'];
	var binaryData=[];

		 for(var i=0;i<binaryarr.length;i++)
	 {
				var json = {
								
								key:binaryarr[i]['key'],
								name:binaryarr[i]['name'],
								parent:binaryarr[i]['parent'],
								isactive:binaryarr[i]['isactive'],
								lock_status:binaryarr[i]['lock_status'],
								child_position:binaryarr[i]['child_position'],
								sponsor:binaryarr[i]['sponsor'],
								date:binaryarr[i]['date'],
								key:binaryarr[i]['key'],
								parent_id:binaryarr[i]['parent_id']
									
							};
							binaryData.push(json);
	 }
	  
     // var binaryData= [{"name":"ops","parent":"null","isactive":"1","lock_status":"unlock","child_position":"","amtpaid":"1.00","sponsor":"virender13","date":"2016-01-05 11:54:56","key":1,"parent_id":1},{"name":"N\/A","parent":"ops","child_position":"L","sponsor":"","isactive":"","lock_status":"","amtpaid":"","date":"","limit":1,"key":2,"parent_id":1},{"name":"ops1","parent":"ops","child_position":"R","sponsor":"virender13","isactive":"1","lock_status":"unlock","amtpaid":"1.00","date":"2016-01-05 12:06:20","limit":1,"key":3,"parent_id":1},{"name":"ops11","parent":"ops1","child_position":"L","sponsor":"ops1","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":3,"key":4,"parent_id":3},{"name":"N\/A","parent":"ops11","child_position":"L","sponsor":"","isactive":"","lock_status":"","amtpaid":"","date":"","limit":3,"key":5,"parent_id":4},{"name":"ops12","parent":"ops11","child_position":"R","sponsor":"virender13","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":3,"key":6,"parent_id":4},{"name":"N\/A","parent":"ops12","child_position":"L","sponsor":"","isactive":"","lock_status":"","amtpaid":"","date":"","limit":4,"key":7,"parent_id":6},{"name":"ops121","parent":"ops12","child_position":"R","sponsor":"virender13","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":4,"key":8,"parent_id":6},{"name":"ops12111","parent":"ops1","child_position":"R","sponsor":"virender13","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":3,"key":9,"parent_id":3}];

      var dataMap = binaryData.reduce(function(map, node) {
          map[node.name] = node;
          return map;
      }, {});

      var json = [];
      binaryData.forEach(function(node) {
          var parent = dataMap[node.parent];
          if (parent) {
              (parent.children || (parent.children = []))
                  .push(node);
          } else {
              json.push(node);
          }
      });
      console.log(json)
      json = json[0];
      var width = 700;
      // if($("#innerpage-wrapper").length > 0 ){
      //   if(typeof($("#innerpage-wrapper").width()) !="undefined" && $("#innerpage-wrapper").width() > 0){
      //     width = 1000; 
      //   }
        
      // }
      var height = 800;
      var maxLabel = 100;
      var duration = 500;
      var radius = 5;
      var circleSize = 15;
      var i = 0;
      var root;
	  var textFontStyle = "300 17px 'Roboto',sans-serif";
	  
	  if($(window).width() < 1024){
          height = 300;
          width = 300;
          maxLabel = 50;
          duration = 50;
          radius = 2;
          circleSize = 10;
          textFontStyle = "300 10px 'Roboto',sans-serif";
      }
      var div = d3.select('#tooltip').append("div") 
        .attr("class", "tooltip")
        .style("opacity", 0);   


      var tree = d3.layout.tree()
        .size([height, width]);

      var diagonal = d3.svg.diagonal()
        .projection(function(d) { return [d.x, d.y]; 
        });

      var svg = d3.select("#tree").append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", "translate(1,30)");

      root = json;
      root.x0 = height / 2;
      root.y0 = 0;

      root.children.forEach(collapse);

      function update(source) {
        console.log(source)
        // Compute the new tree layout.
        var nodes = tree.nodes(root).reverse();
        var links = tree.links(nodes);

        // Normalize for fixed-depth.
        nodes.forEach(function(d) {
          d.y = d.depth * maxLabel;
        });

        // Update the nodes�
        var node = svg.selectAll("g.node")
          .data(nodes, function(d) {
            return d.id || (d.id = ++i);
          });
        // Enter any new nodes at the parent's previous position.
        var nodeEnter = node.enter()
          .append("g")
          .attr("class", "node")
          .attr("transform", function(d) {
            return "translate(" + source.y0 + "," + source.x0 + ")";
          })
          .on("click", click)
          .on("mouseover", function (d) {
                 var r = d3.select(this).node().getBoundingClientRect();
                 /* console.log(d3.select(this));
                         div.transition()
                          .duration(200)    
                          .style("opacity", .9);
                        div .html("Name : "+d.name + "<br/> Sponsor : " + d.sponsor + "<br/> Ammount Paid : "  + d.amtpaid) 
                          .style("display", "block")
                      .style("top", (r.top-25) + "px")
                      .style("left", (r.left-130) + "px")
                      .style("background", "black")
                      .style("font-size", "15px")
                      .style("position", "absolute")*/
var tooltipItem = d3.select(this)
                                .classed("top", true);
			var rectWidth = 150;
              if(d.name !="N/A" || d.sponsor !="" || d.sponsor !="N/A"){
                var nameLength = d.name.length;
                var sponsorLength = d.sponsor.length;
                console.log("Name: - "+nameLength);
                console.log("sponsorLength: - "+sponsorLength);
                if(nameLength > sponsorLength){
                  rectWidth = nameLength *13;
                  console.log("rectWidth1: - "+rectWidth);
                }else{
                  rectWidth = sponsorLength*18;
                  console.log("rectWidth2: - "+rectWidth);
                }
                if(rectWidth < 100){
                  rectWidth = 150;
                }
                console.log("rectWidth: - "+rectWidth);
              }
			  if(d.amtpaid !="undefined" || d.name !="N/A" || d.sponsor !="" || d.sponsor !="N/A")
              {
                if(rectWidth < 100){
                  rectWidth = 200;
                }
              }
              re = tooltipItem.append("rect")
                            .classed('rectInfo', true)
                            //.attr("x",10)
                            .attr("x", function(d) { 
                              return d.children || d._children ? -90 : 10; })
                            .attr("y", 0)   
                            .attr("width", rectWidth)
                            .attr("height", 95)
                            .attr("stroke", "#dfe0e1")
                            .style("z-index","99")
                            .attr("fill", "#f2f2f2");

              var info = tooltipItem.append('text')
                        .classed('toolInfo', true)
                       // .attr('x', 20) 
                        .attr("fill", "#414042")
                        .style("z-index","999")
                        .attr('y', 20)
                        .attr("x", function(d) { 
                            return d.children || d._children ? -70 : 20; })

              info.append('tspan')
                  //.attr('x','20')
                  .attr("x", function(d) { 
                            return d.children || d._children ? - 80 : 20; })
                  .text("USERNAME : "+d.name);


              info.append('tspan')
                // .attr('x','-90')
                .attr("x", function(d) { 
                            return d.children || d._children ? - 80 : 20; })
                .attr('dy','16')
                .text(" ");

              info.append('tspan')
                 // .attr('x','-90')
                  .attr("x", function(d) { 
                            return d.children || d._children ? - 80 : 20; })
                  .attr('dy','16')
                  .text("SPONSOR ID : "+d.sponsor);

               info.append('tspan')
                //.attr('x','-90')
                .attr("x", function(d) { 
                            return d.children || d._children ? - 80 : 20; })
                .attr('dy','16')
                .attr("fill", "#f2f2f2")
                .text("A");

              info.append('tspan')
                  //.attr('x','-90')
                  .attr("x", function(d) { 
                            return d.children || d._children ? - 80 : 20; })
                  .attr('dy','16')
                  .text("AMOUNT PAID : "+d.amtpaid);
                          })
          .on("mouseout", function(){
              /* div.transition()
              .duration(500) 
              .style("opacity", 0);  */
			  d3.select(this).select('text.toolInfo').remove();
              d3.select(this).select('rect.rectInfo').remove();
          });

        nodeEnter.append("circle")
          .attr("r", 0)
          .style("fill", function(d) {
            if(d.isactive == '1'){
            return '#2bb673' ;
            }else{
              return '#ef4136';
            }

          })

		//for heading
         nodeEnter.append("text")
         .attr("y", function(d) { 
          return d.children || d._children ? -30 : 20; })
         .attr("dy", ".70em")
         .style("text-anchor", "right")
		 .style("font", textFontStyle)
         .text(function(d) { return d.name; })
         .style("fill-opacity", 1);

		//for node
          nodeEnter.append("text")
          .text(function(d) { return  ""+d.child_position; })
          .style("text-anchor", "middle")
        //.attr("font-size", "12px")
		  .style("font", textFontStyle)
          .attr("x", 0) 
          .attr("y", 4) 
          .style("fill", function(d) {
            return "#fff";
          });
        // Transition nodes to their new position.
        var nodeUpdate = node.transition()
          .duration(duration)
          .attr("transform", function(d) {
           return "translate(" + d.x + "," + d.y + ")";
           });

        nodeUpdate.select("circle")
          .attr("r", function(d) {
            return computeRadius(d);
          })
          .style("fill", function(d) {
            if(d.isactive == '1'){
            return '#2bb673' ;
            }else{
              return '#ef4136';
            }

          });

        nodeUpdate.select("text").style("fill-opacity", 1);
        nodeUpdate.select("text").style("fill-opacity", 1);
        // Transition exiting nodes to the parent's new position.
        var nodeExit = node.exit().transition()
          .duration(duration)
          .attr("transform", function(d) {
            return "translate(" + source.y + "," + source.x + ")";
          })
          .remove();

        nodeExit.select("circle").attr("r", 0);
        nodeExit.select("text").style("fill-opacity", 0);
        nodeExit.select("text").style("fill-opacity", 0);
        // Update the links�
        var link = svg.selectAll("path.link")
          .data(links, function(d) {
            return d.target.id;
          });

        // Enter any new links at the parent's previous position.
        link.enter().insert("path", "g")
          .attr("class", "link")
          .attr("d", function(d) {
            var o = {
              x: source.x0,
              y: source.y0
            };
            return diagonal({
              source: o,
              target: o
            });
          });

        // Transition links to their new position.
        link.transition()
          .duration(duration)
          .attr("d", diagonal);

        // Transition exiting nodes to the parent's new position.
        link.exit().transition()
          .duration(duration)
          .attr("d", function(d) {
            var o = {
              x: source.x,
              y: source.y
            };
            return diagonal({
              source: o,
              target: o
            });
          })
          .remove();

        // Stash the old positions for transition.
        nodes.forEach(function(d) {
          d.x0 = d.x;
          d.y0 = d.y;
        });
      }

      function computeRadius(d) {

       /* if (d.children || d._children) {
          console.log(radius + (radius * nbEndNodes(d) / 10))
          return radius + (radius * nbEndNodes(d) / 10);
        }
          
        else return radius;*/
         return circleSize;
      }

      function nbEndNodes(n) {
        nb = 0;
        if (n.children) {
          n.children.forEach(function(c) {
            nb += nbEndNodes(c);
          });
        } else if (n._children) {
          n._children.forEach(function(c) {
            nb += nbEndNodes(c);
          });
        } else nb++;

        return nb;
      }

      function click(d) {
    		var uname= d.name;
    	        if (d.children) {
    	          d._children = d.children;
    	          d.children = null;
    	        } else {
    					if (d._children === undefined || d._children === null)
    					{
    					var binaryDt=[];
    						 $.ajax({
    								url:"/gainbitcoin/Binarynetwork/getbinary",
    								type: "POST",    
    								async: false,
    								data: "username="+uname,
    								success: function(dt)
    								{
    									 if(dt!='fail')
    									 {
    								
    									var data= JSON.parse(dt);
    									  
    										if(data.length>1)
    										{
    											for(var i=1;i<data.length;i++)
    											 {
    														var json = {
    																		
    																		key:data[i]['key'],
    																		name:data[i]['name'],
    																		parent:data[i]['parent'],
    																		isactive:data[i]['isactive'],
    																		lock_status:data[i]['lock_status'],
    																		child_position:data[i]['child_position'],
    																		sponsor:data[i]['sponsor'],
    																		date:data[i]['date'],
    																		key:data[i]['key'],
    																		parent_id:data[i]['parent_id']
    																			
    																	};
    																	binaryDt.push(json);
    											 }
    										 }
    									   
    									 }
    								}
    							});
    							if(binaryDt.length>0)
    							{
    								//var delay=1000; //1 second

    								//setTimeout(function() {
    									
    									d.children=binaryDt;
    									d._children = null;
    								//}, delay);
    							}
    							else
    							{
    								d.children = d._children;
    								d._children = null;
    							}
    							
    						//d.children=[{"name":"amol","parent":"ops121","child_position":"R","sponsor":"virender13","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":3,"key":9,"parent_id":3}]
    						//d._children = null;
    					}
    					else
    					{
    						d.children = d._children;
    						d._children = null;
    					}    
    	        }
    	        update(d);
    	      }

      function collapse(d) {
        if (d.children) {
          d._children = d.children;
          d._children.forEach(collapse);
          d.children = null;
        }
      }

      update(root);

      function expand(d){   
          var children = (d.children)?d.children:d._children;
          if (d._children) {        
              d.children = d._children;
              d._children = null;       
          }
          if(children)
            children.forEach(expand);
      }

      function expandAll(root){
          expand(root); 
          update(root);
      }
      expandAll(root);
      function collapseAll(){
          root.children.forEach(collapse);
          collapse(root);
          update(root);
      }
 }//]]> 
	  
	  
	  
	  $("#refresh_network").click(function(){
			var user = $("#child_user").val();
			var master = $("#master").val();
			networkDetails(master,master,1,1);
		});
		
	//networkDetails(userName,1);
	
function networkDetails(userName,master,popup,status){
	if(!popup){
		$("#Popup").show();
	}
	$("#child_user").val(userName);
	$("#parent_user").val(userName);
	var statusParam  = '';
	if(status){
		statusParam  = '&status='+status;
	}
	if(userName){

		$.ajax({
			type:"GET",
			 url: '/gainbitcoin/Network?usr='+userName+'&master='+master,
			success: function(resp){  
			if(!resp || resp==null || resp=='') 
			{
				alert("User not exist!!");
			}
			else
			{
				document.open();
				document.write(resp);
				document.close();
				search_by_level(userName);
			}
			//alert(networkDetails);
				/*if(networkDetails == -1){
					$("#error").html("user not exist");
				}else{
					$("#network").html(networkDetails);
				}*/
					/*var startHead = resp.indexOf("<head>");
				   var endHead = resp.indexOf("</head>");		  
				   var headString = resp.substring(startHead+6,endHead);

				var startBody = resp.indexOf("<body>");
				var endBody = resp.indexOf("</body>");
				var bodyString = resp.substring(startBody+6,endBody);

				  // jQuery('head').html(headString);
				   //jQuery('body').html(bodyString);
				   //createtree();*/
			}
		});
	}
}
//var userName = 'ops';
var userName = $('#parent_user').val();

search_by_level(userName);
function search_by_level(userName){
	if(userName){
		$.ajax({
			type:"POST",
			 url: '/gainbitcoin/Binarynetwork/searchbyuser',
			 data : 'usr='+userName+'&search_by_level=1',
			success: function(networkDetails){  
				$("#search_level").removeAttr('disabled');
				$("#search_level").html(networkDetails);
			}
		});
	}
}

$("#search_level").change(function(){
	// alert($(this).val());
	var level = $(this).val();
	if(level){
		searchUser_by_level(userName,level);
	}
	
});

function searchUser_by_level(userName,level){
	//$("#search_by_level").append('<div id = "ajax-loader2" style = " float: left;"><img src = "/gainbitcoin/images/ajax-loader.gif" style ="width: 70px;" /></div>');

	if(userName){
		$.ajax({
			type:"POST",
			 url: '/gainbitcoin/Binarynetwork/searchbyuser',
			 data: 'usr='+userName+'&level='+level+'&search_by_user=1',
			success: function(networkDetails){ 
				// alert(networkDetails);
				//$("#ajax-loader2").remove();
				$("#search_user").removeAttr('disabled');
				$("#search_user").html(networkDetails);
			}
		});
	}
}

$("#search_user").change(function(){
	// alert($(this).val());
	var UserName = $(this).val();
	var master=$('#master').val();
	if(UserName){
		networkDetails(UserName,master);
	}
});

$("#search_network").click(function(){
	var user = $("#searchUser").val();
	var master=$('#master').val();
	if(user == ''){
		return false;
	}else{
		$("#error").html("");
		networkDetails(user,master);
	}
});

function search_user()
{
		var master=$('#master').val();
		var UserName = $('#username_search').val();
		networkDetails(UserName,master);
}

function createtree()
{
		var binaryarr=JSON.parse($('#binarydatarr').val());;
	$('#child_user').val=binaryarr[0]['name'];
	$('#parent_user').val=binaryarr[0]['name'];
	var binaryData=[];
		 for(var i=0;i<binaryarr.length;i++)
	 {
				var json = {
								
								key:binaryarr[i]['key'],
								name:binaryarr[i]['name'],
								parent:binaryarr[i]['parent'],
								isactive:binaryarr[i]['isactive'],
								lock_status:binaryarr[i]['lock_status'],
								child_position:binaryarr[i]['child_position'],
								sponsor:binaryarr[i]['sponsor'],
								date:binaryarr[i]['date'],
								key:binaryarr[i]['key'],
								parent_id:binaryarr[i]['parent_id']
									
							};
							binaryData.push(json);
	 }
	  
     // var binaryData= [{"name":"ops","parent":"null","isactive":"1","lock_status":"unlock","child_position":"","amtpaid":"1.00","sponsor":"virender13","date":"2016-01-05 11:54:56","key":1,"parent_id":1},{"name":"N\/A","parent":"ops","child_position":"L","sponsor":"","isactive":"","lock_status":"","amtpaid":"","date":"","limit":1,"key":2,"parent_id":1},{"name":"ops1","parent":"ops","child_position":"R","sponsor":"virender13","isactive":"1","lock_status":"unlock","amtpaid":"1.00","date":"2016-01-05 12:06:20","limit":1,"key":3,"parent_id":1},{"name":"ops11","parent":"ops1","child_position":"L","sponsor":"ops1","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":3,"key":4,"parent_id":3},{"name":"N\/A","parent":"ops11","child_position":"L","sponsor":"","isactive":"","lock_status":"","amtpaid":"","date":"","limit":3,"key":5,"parent_id":4},{"name":"ops12","parent":"ops11","child_position":"R","sponsor":"virender13","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":3,"key":6,"parent_id":4},{"name":"N\/A","parent":"ops12","child_position":"L","sponsor":"","isactive":"","lock_status":"","amtpaid":"","date":"","limit":4,"key":7,"parent_id":6},{"name":"ops121","parent":"ops12","child_position":"R","sponsor":"virender13","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":4,"key":8,"parent_id":6},{"name":"ops12111","parent":"ops1","child_position":"R","sponsor":"virender13","isactive":"","lock_status":"unlock","amtpaid":"","date":"","limit":3,"key":9,"parent_id":3}];

      var dataMap = binaryData.reduce(function(map, node) {
          map[node.name] = node;
          return map;
      }, {});

      var json = [];
      binaryData.forEach(function(node) {
          var parent = dataMap[node.parent];
          if (parent) {
              (parent.children || (parent.children = []))
                  .push(node);
          } else {
              json.push(node);
          }
      });
      console.log(json)
      json = json[0];
      var width = 700;
      // if($("#innerpage-wrapper").length > 0 ){
      //   if(typeof($("#innerpage-wrapper").width()) !="undefined" && $("#innerpage-wrapper").width() > 0){
      //     width = 1000; 
      //   }
        
      // }
      var height = 700;
      var maxLabel = 100;
      var duration = 500;
      var radius = 5;
      var circleSize = 15;
      var i = 0;
      var root;
	  var textFontStyle = "300 17px 'Roboto',sans-serif";
	  
	   if($(window).width() < 767){
          height = 300;
          width = 300;
          maxLabel = 50;
          duration = 50;
          radius = 2;
          circleSize = 10;
          textFontStyle = "300 10px 'Roboto',sans-serif";
      }
      var div = d3.select('#tooltip').append("div") 
        .attr("class", "tooltip")
        .style("opacity", 0);   


      var tree = d3.layout.tree()
        .size([height, width]);

      var diagonal = d3.svg.diagonal()
        .projection(function(d) { return [d.x, d.y]; 
        });

      var svg = d3.select("#tree").append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", "translate(1,30)");

      root = json;
      root.x0 = height / 2;
      root.y0 = 0;

      root.children.forEach(collapse);
	   update(root);
	    expandAll(root);
}

	  
   </script>
   


       <!-- /#Footer End-wrapper Here -->
	
 </div>
</body>
<script>
function changepagination()
{
	if($("#data-table-simple_previous").length == 0) {

	}
	else{

	/* var innerhtml='<img alt="" src="images/leftarw.png">';
	$("#data-table-simple_previous").empty();
	$("#data-table-simple_previous").append(innerhtml); */
	$('#data-table-simple_wrapper .row').append("<div class='clearfix' style='background-color: #FFFFFF! important; float: left; width: 100%; height: 24px;'> </div>");

	/*$('#data-table-simple_filter').parents('.col-sm-6').append("<div class='clearfix' style='background-color: #FFFFFF! important; float: left; width: 100%; height: 24px;'> </div>");
*/	} 
	
	/* if($("#data-table-simple_next").length == 0) { 
	
	}
	else{

	var innerhtml='<img alt="" src="images/rightarw.png">';
	$("#data-table-simple_next").empty();
	$("#data-table-simple_next").append(innerhtml);
	}*/
}

function closeoffer()
{
	$('#myModal').removeClass('openpop');
}

function showmyoffer()
{
	$('#myModaloffer').addClass('openpop');
}
function hidemyoffer() 
{
	$('#myModaloffer').removeClass('openpop');
}

function contactDetails()
{
			var fullname=$('#name').val();
			var username=$('#username').val();
			var email_address=$('#email_address').val();
			var mobile=$('#mobile').val();
			var captcha=$('#captcha').val();
			var ol_captcha=$('#ol_captcha').val();
			var country=($('#countryCode :selected').val());
			var country_name=$('#country_name').val();
			
	if(email_address!='')
	{
	    var atpos = email_address.indexOf("@");
	    var dotpos = email_address.lastIndexOf(".");
	}

	if(!fullname || fullname=='' )
	{
		$("#err_div").css("display", "block");
		document.getElementById("err_div").innerHTML="";
		document.getElementById("err_div").innerHTML="Please provide Full name.";
		$('#err_div').css('display','block');
		$('#err_div').css('color','red');
		return false;
	}

	else if(!email_address || email_address=='')
	{
		$("#err_div").css("display", "block");
		document.getElementById("err_div").innerHTML="";
		document.getElementById("err_div").innerHTML="Please provide Email.";
		$('#err_div').css('display','block');
		$('#err_div').css('color','red');
		return false;
	}
	else if(atpos<1 || dotpos<atpos+2 || dotpos+2>=email_address.length)
	{
		$("#err_div").css("display", "block");
		document.getElementById("err_div").innerHTML="";
		document.getElementById("err_div").innerHTML="Please provide valid Email.";
		$('#err_div').css('display','block');
		$('#err_div').css('color','red');
		return false;
	}
	else if(!mobile || mobile=='' )
	{
		$("#err_div").css("display", "block");
		document.getElementById("err_div").innerHTML="";
		document.getElementById("err_div").innerHTML="Please provide Mobile.";
		$('#err_div').css('display','block');
		$('#err_div').css('color','red');
		return false;
	}
	else if(!country_name || country_name=='' )
	{
		$("#err_div").css("display", "block");
		document.getElementById("err_div").innerHTML="";
		document.getElementById("err_div").innerHTML="Please provide Country.";
		$('#err_div').css('display','block');
		$('#err_div').css('color','red');
		return false;
	}
	else if(!captcha || captcha=='' )
	{
		$("#err_div").css("display", "block");
		document.getElementById("err_div").innerHTML="";
		document.getElementById("err_div").innerHTML="Please provide Captcha.";
		$('#err_div').css('display','block');
		$('#err_div').css('color','red');
		return false;
	}
	else
	{
			var dataString = 'name='+fullname+'&email_address='+email_address+'&mobile='+mobile+'&countryCode='+country+'&country_name='+country_name+'&captcha='+captcha+'&ol_captcha='+ol_captcha;
				 $.ajax({
						url:"/gainbitcoin/Dashboard/savecont",
						type: "POST",    
					    data: dataString,
				  		success: function(response)
			      		{
						
						 $("#err_div").css("display", "block");
						document.getElementById("err_div").innerHTML=response;
					
						$('#notify_popup_container ').removeClass('openpop');
						
			      			
			      		}
					});
	
	}
}
function closeCatPopup()
{
	$('#req-admin').removeClass('openpop');
}

function selectCountry(opt)
{
	alert(opt.value);
	var code=opt.value;
	//var name=$("#country_name option[value="+ccode+"]").text();
	//alert(name);
	 $.ajax({
			url:"/gainbitcoin/Dashboard/getcountry",
			type: "POST",    
		    data: "code="+code+"&type=ccode",
	  		success: function(response)
   		{
			 if(response!='fail')
			 {
				alert(response);
				//$('#country_name option[value="response"]');
				$("#country_name").val(response);
			 }
			
   			
   		}
		});
	
}
function selectCcode(opt)
{
	var code=opt.value;


	 $.ajax({
			url:"/gainbitcoin/Dashboard/getcountry",
			type: "POST",    
		    data: "code="+code+"&type=country", 
	  		success: function(response)
		{
			 if(response!='fail')
			 {
				alert(response);
				//$('#country_name option[value="response"]');
				$("#countryCode").val(response);
			 }
			
			
		}
		});
}
</script>
	   <script src="/gainbitcoin/js/common.js"></script> 
	   <script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en', includedLanguages: 'af,de,en,es,la,ml,ms,nl,ta,zh-CN', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
}
</script><script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</html>

